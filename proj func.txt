create or replace FUNCTION        "FUNC_PROJ_PRE_REQ" (siteProjectsId NUMBER, milestoneName VARCHAR2)
RETURN CLOB
AS
preReq CLOB;
v_check VARCHAR2(32);
v_bool Boolean;
v_dismantlement VARCHAR2(32);
v_whereClause VARCHAR2(64);
v_query CLOB;
tableName VARCHAR2(1024);
dataList CLOB;
fieldsData CLOB;
powerCompltDt VARCHAR2(64);
v_hubTransportVendor VARCHAR2(32);
--v_transportType VARCHAR2(64);
BEGIN
    BEGIN
	SELECT CASE WHEN SP.TYPE = 'Modification' AND (PAI.PROJ_MOD_TYPE IS NULL OR PAI.PROJ_MOD_TYPE IN ('DISMANTLEMENT')) THEN 'false' ELSE 'true' END INTO v_dismantlement
	FROM SITE_PROJECTS SP
	INNER JOIN PROJ_ADDITIONAL_INFO PAI ON PAI.SITE_PROJECTS_ID = SP.SITE_PROJECTS_ID
	AND SP.SITE_PROJECTS_ID = siteProjectsId;
    EXCEPTION WHEN NO_DATA_FOUND THEN
	    v_dismantlement := 'false';
    END;
    IF(v_dismantlement = 'true') THEN
	-- FOR FIELDS IN (SELECT * FROM ENUM_REFERENCE WHERE GROUP_NAME = 'PROJECTS_SETTINGS' AND SUB_TYPE = 'PRE_REQ'
	 -- )LOOP
	  --DBMS_OUTPUT.PUT_LINE('Field Name: '||FIELDS.NAME);
	    dataList := NULL;
	    FOR FIELD_LIST IN (SELECT MODULE,TABLE_NAME,dbms_xmlgen.convert(RTRIM(XMLAGG(XMLELEMENT(E,D,'||'',''||')).EXTRACT('E/text()').getCLOBVal(),'||'),1) AS fields FROM
				(SELECT MODULE,TABLE_NAME,
                CASE WHEN TABLE_NAME = 'VDU_ORCHESTRATION' AND FIELD_NAME != 'VCP_FE_INSTALLATION_AC_DT' 
                    THEN '''"' || TITLE || '":"''' || ' || CASE WHEN COUNT(' || FIELD_NAME || ') = COUNT(*) THEN TO_CHAR(MAX(' || FIELD_NAME || '),''MM/DD/RRRR'') ELSE '''' END ||' || '''"'''
                WHEN TABLE_NAME = 'VDU_ORCHESTRATION' AND FIELD_NAME = 'VCP_FE_INSTALLATION_AC_DT' 
                    THEN '''"' || TITLE || '":"''' || '||CASE WHEN COUNT(' || FIELD_NAME || ') = COUNT(*) THEN TO_CHAR(MAX(TO_DATE(' || FIELD_NAME || ',''MM/DD/RRRR'')),''MM/DD/RRRR'') ELSE '''' END ||' || '''"'''
                ELSE '''"' || TITLE || '":"''' || '||' || FIELD_NAME || '||' || '''"''' END AS D
				FROM FUZE_TRACKER_FIELD_CONFIG FTFC
				WHERE
				FIELD_NAME IN (SELECT  MMM.DEPENDENT_FIELD FROM PROJ_MAJOR_MILESTONE_MAPPING MMM
				    inner join FUZE_TRACKER_FIELD_CONFIG FTFC on MMM.MAJOR_MILESTONE = FTFC.FIELD_NAME
				    where MMM.IS_MANDATORY in ('C','MC','VDU')
				    and FTFC.EDIT_RULE = 'CALCULATED_DATE'
				    and FTFC.workstep_name = milestoneName
				    )
				) T GROUP BY MODULE,TABLE_NAME
	    ) LOOP
		DBMS_OUTPUT.PUT_LINE('MODULE NAME ::'||FIELD_LIST.MODULE);
		 DBMS_OUTPUT.PUT_LINE('FIELDS::'||FIELD_LIST.fields);
	       IF(FIELD_LIST.TABLE_NAME = 'SPM_PROJECT_TRACKER') THEN
		    v_whereClause := 'FUZE_PROJECT_ID';
		ELSE
		    v_whereClause := 'SITE_PROJECTS_ID';
		END IF;
		IF (FIELD_LIST.TABLE_NAME NOT IN ( 'PROJECT_TRACKER_WORKSTEP_STATUS','VDU_ORCHESTRATION')) THEN
		    v_query := 'SELECT ' || to_char(FIELD_LIST.fields) || '
				FROM SITE_PROJECTS SP
				LEFT OUTER JOIN ' || FIELD_LIST.TABLE_NAME || ' T ON T.'||v_whereClause||' = SP.SITE_PROJECTS_ID
				WHERE SP.SITE_PROJECTS_ID = ' || siteProjectsId;
		    DBMS_OUTPUT.PUT_LINE(v_query);
		    EXECUTE IMMEDIATE v_query into fieldsData;
		    DBMS_OUTPUT.PUT_LINE('IF fieldsData::'|| fieldsData );
        ELSIF(FIELD_LIST.TABLE_NAME = 'VDU_ORCHESTRATION')THEN

             v_query := 'SELECT ' || to_char(FIELD_LIST.fields) || '
				FROM SITE_PROJECTS SP
				LEFT OUTER JOIN ' || FIELD_LIST.TABLE_NAME || ' T ON T.'||v_whereClause||' = SP.SITE_PROJECTS_ID
                AND VRAN_ORCHESTRATION_PATH = ''FULL_ORCHESTRATION''
				WHERE SP.SITE_PROJECTS_ID = ' || siteProjectsId;
                DBMS_OUTPUT.PUT_LINE(v_query);

		    DBMS_OUTPUT.PUT_LINE('IF fieldsData::'|| fieldsData );

            EXECUTE IMMEDIATE v_query into fieldsData;
		    DBMS_OUTPUT.PUT_LINE('IF fieldsData::'|| fieldsData );
		ELSE
		    SELECT dbms_xmlgen.convert(XMLAGG(XMLELEMENT(E,FLDDATA,',')).EXTRACT('E/text()').getCLOBVal(),1) INTO fieldsData
		    FROM (
			SELECT '"' || FTFC.TITLE || '":"' || PTWS1.COMPLETED_DATE ||'"' AS FLDDATA
			FROM FUZE_TRACKER_FIELD_CONFIG FTFC
			inner join (
			    SELECT * FROM (
								SELECT MAJOR_MS_CANDIDATE_SELECTION_COMPLETED_DATE, MAJOR_MS_ACTIVATION_COMPLETED_DATE,MINOR_MS_ACTIVATION_NON_RF_COMPLETED_DATE,MINOR_MS_AE_COMPLETED_DATE,MINOR_MS_CANDIDATE_ACCEPTED_COMPLETED_DATE,MINOR_MS_CANDIDATE_SUBMITTED_COMPLETED_DATE,
				MINOR_MS_CONSTRUCTION_REVIEW_COMPLETED_DATE,MINOR_MS_RF_ACCEPT_RANKING_COMPLETED_DATE,MINOR_MS_TRANSPORT_REVIEW_COMPLETED_DATE,MINOR_MS_CLOSEOUT_DOCUMENTS_UPLOAD_COMPLETED_DATE,
				MINOR_MS_PHOTO_DOCUMENTS_COMPLETED_DATE,MINOR_MS_CREATE_CQ_COMPLETED_DATE,MINOR_MS_CQ_EQUIPMENT_COMPLETED_DATE,MINOR_MS_IP_COMPLETE_COMPLETED_DATE,
				MINOR_MS_READY_FOR_ASSURANCE_COMPLETED_DATE,MINOR_MS_RF_COMPLETE_DATE,MINOR_MS_SP_COMPLETE_COMPLETED_DATE,MINOR_MS_TRANSPORT_COMPLETE_COMPLETED_DATE,
				MINOR_MS_CONSTRUCTION_READY_COMPLETED_DATE,MINOR_MS_PRE_TCN_COMPLETED_DATE,MINOR_MS_CREATE_PROJECT_COMPLETED_DATE,
				MINOR_MS_CONFIRM_E911_ADDRESS_COMPLETED_DATE,MINOR_MS_CONFIRM_E911_SUBMITTED_COMPLETED_DATE,MINOR_MS_CONFIRM_TVW_RECEIVED_COMPLETED_DATE,MINOR_MS_EDGE_EQUIPMENT_CLOSEOUT_COMPLETED_DATE,
				MINOR_MS_EDGE_EQUIPMENT_INFORMATION_COMPLETED_DATE,MINOR_MS_EDGE_EQUIPMENT_INSTALL_COMPLETED_DATE,MINOR_MS_EDGE_FUNDING_COMPLETED_DATE,MINOR_MS_EDGE_INTEGRATE_COMPLETED_DATE,
				MINOR_MS_EDGE_PROJECT_INFO_COMPLETED_DATE,MINOR_MS_EDGE_PSC_VETTING_COMPLETED_DATE,MINOR_MS_EDGE_VENDOR_SERVICE_INSTALL_COMPLETED_DATE,MINOR_MS_ENVIRONMENTAL_REVIEW_COMPLETED_DATE,
				MINOR_MS_GLOBAL_EHS_REVIEW_COMPLETED_DATE,MINOR_MS_TERRITORY_REVIEW_COMPLETED_DATE,MINOR_MS_TSDF_REVIEW_COMPLETED_DATE,MINOR_MS_BOM_COMPLETE_COMPLETED_DATE,MINOR_MS_EQUIPMENT_PROCUREMENT_COMPLETE_COMPLETED_DATE,
				MAJOR_MS_HUB_READY_COMPLETED_DATE,MINOR_MS_INTEGRATION_COMPLETED_DATE,MINOR_MS_LEASING_COMPLETED_DATE,MAJOR_MS_NETWORK_ASSURANCE_COMPLETED_DATE,MINOR_MS_PERMITTING_COMPLETED_DATE,
				MINOR_MS_CONSTRUCTION_FORM_COMPLETED_DATE,MINOR_MS_ENV_CONST_CLOSEOUT_INFO_COMPLETED_DATE,
				MINOR_MS_POST_TCN_COMPLETED_DATE,MINOR_MS_RFE_MITIGATION_DOCS_COMPLETED_DATE,MINOR_MS_POWER_VETTING_COMPLETED_DATE,MINOR_MS_POWER_COMPLETE_COMPLETED_DATE,MINOR_MS_POWER_UTILITIES_TERMINATION_COMPLETED_DATE,MINOR_MS_UTILITY_INFORMATION_COMPLETED_DATE,
				MINOR_MS_PSC_CONSTRUCTION_COMPLETED_DATE,MINOR_MS_PSC_DESIGN_COMPLETED_DATE,MINOR_MS_PSC_PRE_CONSTRUCTION_COMPLETED_DATE,MINOR_MS_PSC_PROJ_DETAILS_COMPLETED_DATE,MINOR_MS_PSLC_FUNDING_COMPLETED_DATE,
				MAJOR_MS_REAL_ESTATE_COMPLETED_DATE,MINOR_MS_AM_FURTHER_STUDY_COMPLETED_DATE,MINOR_MS_ASR_FORM_COMPLETED_DATE,MINOR_MS_FAA_FORM_COMPLETED_DATE,MINOR_MS_FULL_CONSTRUCTION_APPROVAL_COMPLETED_DATE,
				MINOR_MS_GROUND_ONLY_APPROVAL_COMPLETED_DATE,MINOR_MS_STRUCTURE_FORM_COMPLETED_DATE,MINOR_MS_SUBMIT_FOR_NEPA_COMPLETED_DATE,MINOR_MS_SURVEY_COMPLETED_DATE,MINOR_MS_REGULATORY_DISMANTLEMENT_COMPLETED_DATE,
				MINOR_MS_REGULATORY_INSERVICE_COMPLETED_DATE,MINOR_MS_CARRIER_AGREEMENT_COMPLETED_DATE,MINOR_MS_CREATE_RFDS_COMPLETED_DATE,MINOR_MS_INSERVICE_DOCUMENTS_COMPLETED_DATE,MINOR_MS_INTERNATIONAL_BORDER_COMPLETED_DATE,
				MINOR_MS_QUIET_ZONE_COMPLETED_DATE,MINOR_MS_RFE_COMPLETED_DATE,MINOR_MS_SUBMIT_RFDS_COMPLETED_DATE,MINOR_MS_RFDS_IBV_COMPLETED_DATE,MINOR_MS_SELECT_VENDOR_COMPLETED_DATE,MINOR_MS_MICROWAVE_COMPLETED_DATE,MINOR_MS_ONE_FIBER_COMPLETED_DATE,
				MINOR_MS_TRANSPORT_CONTRACT_COMPLETED_DATE,MINOR_MS_TRANSPORT_DELIVERY_COMPLETED_DATE,MINOR_MS_ZONING_COMPLETED_DATE,MINOR_MS_EQUIPMENT_COMPLETED_DATE, MAJOR_MS_PHYSICAL_CONSTRUCTION_COMPLETE_COMPLETED_DATE, MAJOR_MS_TRANSPORT_COMPLETED_DATE, MINOR_MS_CONQUEST_COMPLETED_DATE, MAJOR_MS_POWER_COMPLETED_DATE, MINOR_MS_ENVIRONMENT_DUE_DILIGENCE_COMPLETED_DATE, MINOR_MS_REGULATORY_COMPLETED_DATE,
				MINOR_MS_VCP_ORCHESTRATION_COMPLETED_DATE,MAJOR_MS_RTC_COMPLETED_DATE,MINOR_MS_CONSTRUCTION_48HR_REVIEW_COMPLETED_DATE,MINOR_MS_RF_48HR_REVIEW_COMPLETED_DATE,MINOR_MS_BUILD_CONSTRUCTION_COMPLETE_COMPLETED_DATE,MINOR_MS_ENVIRONMENTAL_NOTICE_TO_CONTRACTOR_COMPLETED_DATE,MINOR_MS_REGULATORY_48HR_REVIEW_COMPLETED_DATE,MINOR_MS_REGULATORY_CONSTRUCTION_SR_COMPLETED_DATE,
                MINOR_MS_VCP_FAR_EDGE_INSTALLATION_COMPLETED_DATE,MINOR_MS_DC_DISCOVERY_COMPLETED_DATE,MINOR_MS_FAR_EDGE_INSTANTIATION_COMPLETED_DATE,MINOR_MS_VDU_DAY_0_COMPLETE_COMPLETED_DATE,
                MINOR_MS_VDU_DAY_1_COMPLETE_COMPLETED_DATE,MINOR_MS_VDU_DEPLOY_READINESS_COMPLETED_DATE,MINOR_MS_VCP_SUBCLOUD_DEPLOYMENT_INITIATED_COMPLETED_DATE
				FROM PROJECT_TRACKER_WORKSTEP_STATUS WHERE SITE_PROJECTS_ID = siteProjectsId
			    ) UNPIVOT INCLUDE NULLS( COMPLETED_DATE FOR FIELD_NAME IN (
							MAJOR_MS_CANDIDATE_SELECTION_COMPLETED_DATE AS 'MAJOR_MS_CANDIDATE_SELECTION_COMPLETED_DATE',
			    MAJOR_MS_ACTIVATION_COMPLETED_DATE AS 'MAJOR_MS_ACTIVATION_COMPLETED_DATE',
			    MINOR_MS_ACTIVATION_NON_RF_COMPLETED_DATE AS 'MINOR_MS_ACTIVATION_NON_RF_COMPLETED_DATE',
			    MINOR_MS_AE_COMPLETED_DATE AS 'MINOR_MS_AE_COMPLETED_DATE',
			    MINOR_MS_CANDIDATE_ACCEPTED_COMPLETED_DATE AS 'MINOR_MS_CANDIDATE_ACCEPTED_COMPLETED_DATE',
			    MINOR_MS_CANDIDATE_SUBMITTED_COMPLETED_DATE AS 'MINOR_MS_CANDIDATE_SUBMITTED_COMPLETED_DATE',
			    MINOR_MS_CONSTRUCTION_REVIEW_COMPLETED_DATE AS 'MINOR_MS_CONSTRUCTION_REVIEW_COMPLETED_DATE',
			    MINOR_MS_RF_ACCEPT_RANKING_COMPLETED_DATE AS 'MINOR_MS_RF_ACCEPT_RANKING_COMPLETED_DATE',
			    MINOR_MS_TRANSPORT_REVIEW_COMPLETED_DATE AS 'MINOR_MS_TRANSPORT_REVIEW_COMPLETED_DATE',
			    MINOR_MS_CLOSEOUT_DOCUMENTS_UPLOAD_COMPLETED_DATE AS 'MINOR_MS_CLOSEOUT_DOCUMENTS_UPLOAD_COMPLETED_DATE',
			    MINOR_MS_PHOTO_DOCUMENTS_COMPLETED_DATE AS 'MINOR_MS_PHOTO_DOCUMENTS_COMPLETED_DATE',
			    MINOR_MS_CREATE_CQ_COMPLETED_DATE AS 'MINOR_MS_CREATE_CQ_COMPLETED_DATE',
			    MINOR_MS_CQ_EQUIPMENT_COMPLETED_DATE AS 'MINOR_MS_CQ_EQUIPMENT_COMPLETED_DATE',
			    MINOR_MS_IP_COMPLETE_COMPLETED_DATE AS 'MINOR_MS_IP_COMPLETE_COMPLETED_DATE',
			    MINOR_MS_READY_FOR_ASSURANCE_COMPLETED_DATE AS 'MINOR_MS_READY_FOR_ASSURANCE_COMPLETED_DATE',
			    MINOR_MS_RF_COMPLETE_DATE AS 'MINOR_MS_RF_COMPLETE_DATE',
			    MINOR_MS_SP_COMPLETE_COMPLETED_DATE AS 'MINOR_MS_SP_COMPLETE_COMPLETED_DATE',
			    MINOR_MS_TRANSPORT_COMPLETE_COMPLETED_DATE AS 'MINOR_MS_TRANSPORT_COMPLETE_COMPLETED_DATE',
			    MINOR_MS_CONSTRUCTION_READY_COMPLETED_DATE AS 'MINOR_MS_CONSTRUCTION_READY_COMPLETED_DATE',
			    MINOR_MS_PRE_TCN_COMPLETED_DATE AS 'MINOR_MS_PRE_TCN_COMPLETED_DATE',
			    MINOR_MS_CREATE_PROJECT_COMPLETED_DATE AS 'MINOR_MS_CREATE_PROJECT_COMPLETED_DATE',
			    MINOR_MS_CONFIRM_E911_ADDRESS_COMPLETED_DATE AS 'MINOR_MS_CONFIRM_E911_ADDRESS_COMPLETED_DATE',
			    MINOR_MS_CONFIRM_E911_SUBMITTED_COMPLETED_DATE AS 'MINOR_MS_CONFIRM_E911_SUBMITTED_COMPLETED_DATE',
			    MINOR_MS_CONFIRM_TVW_RECEIVED_COMPLETED_DATE AS 'MINOR_MS_CONFIRM_TVW_RECEIVED_COMPLETED_DATE',
			    MINOR_MS_EDGE_EQUIPMENT_CLOSEOUT_COMPLETED_DATE AS 'MINOR_MS_EDGE_EQUIPMENT_CLOSEOUT_COMPLETED_DATE',
			    MINOR_MS_EDGE_EQUIPMENT_INFORMATION_COMPLETED_DATE AS 'MINOR_MS_EDGE_EQUIPMENT_INFORMATION_COMPLETED_DATE',
			    MINOR_MS_EDGE_EQUIPMENT_INSTALL_COMPLETED_DATE AS 'MINOR_MS_EDGE_EQUIPMENT_INSTALL_COMPLETED_DATE',
			    MINOR_MS_EDGE_FUNDING_COMPLETED_DATE AS 'MINOR_MS_EDGE_FUNDING_COMPLETED_DATE',
			    MINOR_MS_EDGE_INTEGRATE_COMPLETED_DATE AS 'MINOR_MS_EDGE_INTEGRATE_COMPLETED_DATE',
			    MINOR_MS_EDGE_PROJECT_INFO_COMPLETED_DATE AS 'MINOR_MS_EDGE_PROJECT_INFO_COMPLETED_DATE',
			    MINOR_MS_EDGE_PSC_VETTING_COMPLETED_DATE AS 'MINOR_MS_EDGE_PSC_VETTING_COMPLETED_DATE',
			    MINOR_MS_EDGE_VENDOR_SERVICE_INSTALL_COMPLETED_DATE AS 'MINOR_MS_EDGE_VENDOR_SERVICE_INSTALL_COMPLETED_DATE',
			    MINOR_MS_ENVIRONMENTAL_REVIEW_COMPLETED_DATE AS 'MINOR_MS_ENVIRONMENTAL_REVIEW_COMPLETED_DATE',
			    MINOR_MS_GLOBAL_EHS_REVIEW_COMPLETED_DATE AS 'MINOR_MS_GLOBAL_EHS_REVIEW_COMPLETED_DATE',
			    MINOR_MS_TERRITORY_REVIEW_COMPLETED_DATE AS 'MINOR_MS_TERRITORY_REVIEW_COMPLETED_DATE',
			    MINOR_MS_TSDF_REVIEW_COMPLETED_DATE AS 'MINOR_MS_TSDF_REVIEW_COMPLETED_DATE',
			    MINOR_MS_BOM_COMPLETE_COMPLETED_DATE AS 'MINOR_MS_BOM_COMPLETE_COMPLETED_DATE',
			    MINOR_MS_EQUIPMENT_PROCUREMENT_COMPLETE_COMPLETED_DATE AS 'MINOR_MS_EQUIPMENT_PROCUREMENT_COMPLETE_COMPLETED_DATE',
			    MAJOR_MS_HUB_READY_COMPLETED_DATE AS 'MAJOR_MS_HUB_READY_COMPLETED_DATE',
			    MINOR_MS_INTEGRATION_COMPLETED_DATE AS 'MINOR_MS_INTEGRATION_COMPLETED_DATE',
			    MINOR_MS_LEASING_COMPLETED_DATE AS 'MINOR_MS_LEASING_COMPLETED_DATE',
			    MAJOR_MS_NETWORK_ASSURANCE_COMPLETED_DATE AS 'MAJOR_MS_NETWORK_ASSURANCE_COMPLETED_DATE',
			    MINOR_MS_PERMITTING_COMPLETED_DATE AS 'MINOR_MS_PERMITTING_COMPLETED_DATE',
			    MINOR_MS_CONSTRUCTION_FORM_COMPLETED_DATE AS 'MINOR_MS_CONSTRUCTION_FORM_COMPLETED_DATE',
			    MINOR_MS_ENV_CONST_CLOSEOUT_INFO_COMPLETED_DATE AS 'MINOR_MS_ENV_CONST_CLOSEOUT_INFO_COMPLETED_DATE',
			    MINOR_MS_POST_TCN_COMPLETED_DATE AS 'MINOR_MS_POST_TCN_COMPLETED_DATE',
			    MINOR_MS_RFE_MITIGATION_DOCS_COMPLETED_DATE AS 'MINOR_MS_RFE_MITIGATION_DOCS_COMPLETED_DATE',
			    MINOR_MS_POWER_COMPLETE_COMPLETED_DATE AS 'MINOR_MS_POWER_COMPLETE_COMPLETED_DATE',
		MINOR_MS_POWER_VETTING_COMPLETED_DATE AS 'MINOR_MS_POWER_VETTING_COMPLETED_DATE',
			    MINOR_MS_POWER_UTILITIES_TERMINATION_COMPLETED_DATE AS 'MINOR_MS_POWER_UTILITIES_TERMINATION_COMPLETED_DATE',
			    MINOR_MS_UTILITY_INFORMATION_COMPLETED_DATE AS 'MINOR_MS_UTILITY_INFORMATION_COMPLETED_DATE',
			    MINOR_MS_PSC_CONSTRUCTION_COMPLETED_DATE AS 'MINOR_MS_PSC_CONSTRUCTION_COMPLETED_DATE',
			    MINOR_MS_PSC_DESIGN_COMPLETED_DATE AS 'MINOR_MS_PSC_DESIGN_COMPLETED_DATE',
			    MINOR_MS_PSC_PRE_CONSTRUCTION_COMPLETED_DATE AS 'MINOR_MS_PSC_PRE_CONSTRUCTION_COMPLETED_DATE',
			    MINOR_MS_PSC_PROJ_DETAILS_COMPLETED_DATE AS 'MINOR_MS_PSC_PROJ_DETAILS_COMPLETED_DATE',
			    MINOR_MS_PSLC_FUNDING_COMPLETED_DATE AS 'MINOR_MS_PSLC_FUNDING_COMPLETED_DATE',
			    MAJOR_MS_REAL_ESTATE_COMPLETED_DATE AS 'MAJOR_MS_REAL_ESTATE_COMPLETED_DATE',
			    MINOR_MS_AM_FURTHER_STUDY_COMPLETED_DATE AS 'MINOR_MS_AM_FURTHER_STUDY_COMPLETED_DATE',
			    MINOR_MS_ASR_FORM_COMPLETED_DATE AS 'MINOR_MS_ASR_FORM_COMPLETED_DATE',
			    MINOR_MS_FAA_FORM_COMPLETED_DATE AS 'MINOR_MS_FAA_FORM_COMPLETED_DATE',
			    MINOR_MS_FULL_CONSTRUCTION_APPROVAL_COMPLETED_DATE AS 'MINOR_MS_FULL_CONSTRUCTION_APPROVAL_COMPLETED_DATE',
			    MINOR_MS_GROUND_ONLY_APPROVAL_COMPLETED_DATE AS 'MINOR_MS_GROUND_ONLY_APPROVAL_COMPLETED_DATE',
			    MINOR_MS_STRUCTURE_FORM_COMPLETED_DATE AS 'MINOR_MS_STRUCTURE_FORM_COMPLETED_DATE',
			    MINOR_MS_SUBMIT_FOR_NEPA_COMPLETED_DATE AS 'MINOR_MS_SUBMIT_FOR_NEPA_COMPLETED_DATE',
			    MINOR_MS_SURVEY_COMPLETED_DATE AS 'MINOR_MS_SURVEY_COMPLETED_DATE',
			    MINOR_MS_REGULATORY_DISMANTLEMENT_COMPLETED_DATE AS 'MINOR_MS_REGULATORY_DISMANTLEMENT_COMPLETED_DATE',
			    MINOR_MS_REGULATORY_INSERVICE_COMPLETED_DATE AS 'MINOR_MS_REGULATORY_INSERVICE_COMPLETED_DATE',
			    MINOR_MS_CARRIER_AGREEMENT_COMPLETED_DATE AS 'MINOR_MS_CARRIER_AGREEMENT_COMPLETED_DATE',
			    MINOR_MS_CREATE_RFDS_COMPLETED_DATE AS 'MINOR_MS_CREATE_RFDS_COMPLETED_DATE',
			    MINOR_MS_INSERVICE_DOCUMENTS_COMPLETED_DATE AS 'MINOR_MS_INSERVICE_DOCUMENTS_COMPLETED_DATE',
			    MINOR_MS_INTERNATIONAL_BORDER_COMPLETED_DATE AS 'MINOR_MS_INTERNATIONAL_BORDER_COMPLETED_DATE',
			    MINOR_MS_QUIET_ZONE_COMPLETED_DATE AS 'MINOR_MS_QUIET_ZONE_COMPLETED_DATE',
			    MINOR_MS_RFE_COMPLETED_DATE AS 'MINOR_MS_RFE_COMPLETED_DATE',
			    MINOR_MS_SUBMIT_RFDS_COMPLETED_DATE AS 'MINOR_MS_SUBMIT_RFDS_COMPLETED_DATE',
			    MINOR_MS_RFDS_IBV_COMPLETED_DATE AS 'MINOR_MS_RFDS_IBV_COMPLETED_DATE',
			    MINOR_MS_SELECT_VENDOR_COMPLETED_DATE AS 'MINOR_MS_SELECT_VENDOR_COMPLETED_DATE',
			    MINOR_MS_MICROWAVE_COMPLETED_DATE AS 'MINOR_MS_MICROWAVE_COMPLETED_DATE',
			    MINOR_MS_ONE_FIBER_COMPLETED_DATE AS 'MINOR_MS_ONE_FIBER_COMPLETED_DATE',
			    MINOR_MS_TRANSPORT_CONTRACT_COMPLETED_DATE AS 'MINOR_MS_TRANSPORT_CONTRACT_COMPLETED_DATE',
			    MINOR_MS_TRANSPORT_DELIVERY_COMPLETED_DATE AS 'MINOR_MS_TRANSPORT_DELIVERY_COMPLETED_DATE',
			    MINOR_MS_ZONING_COMPLETED_DATE AS 'MINOR_MS_ZONING_COMPLETED_DATE',
			    MINOR_MS_EQUIPMENT_COMPLETED_DATE AS 'MINOR_MS_EQUIPMENT_COMPLETED_DATE',
			    MAJOR_MS_PHYSICAL_CONSTRUCTION_COMPLETE_COMPLETED_DATE AS 'MAJOR_MS_PHYSICAL_CONSTRUCTION_COMPLETE_COMPLETED_DATE',
			    MAJOR_MS_TRANSPORT_COMPLETED_DATE AS 'MAJOR_MS_TRANSPORT_COMPLETED_DATE',
			    MINOR_MS_CONQUEST_COMPLETED_DATE as 'MINOR_MS_CONQUEST_COMPLETED_DATE',
			    MAJOR_MS_POWER_COMPLETED_DATE as 'MAJOR_MS_POWER_COMPLETED_DATE',
			    MINOR_MS_ENVIRONMENT_DUE_DILIGENCE_COMPLETED_DATE AS 'MINOR_MS_ENVIRONMENT_DUE_DILIGENCE_COMPLETED_DATE',
			    MINOR_MS_REGULATORY_COMPLETED_DATE AS 'MINOR_MS_REGULATORY_COMPLETED_DATE',
			    MINOR_MS_VCP_ORCHESTRATION_COMPLETED_DATE AS 'MINOR_MS_VCP_ORCHESTRATION_COMPLETED_DATE',
			    MAJOR_MS_RTC_COMPLETED_DATE AS 'MAJOR_MS_RTC_COMPLETED_DATE',
		MINOR_MS_CONSTRUCTION_48HR_REVIEW_COMPLETED_DATE AS 'MINOR_MS_CONSTRUCTION_48HR_REVIEW_COMPLETED_DATE',
				MINOR_MS_RF_48HR_REVIEW_COMPLETED_DATE AS 'MINOR_MS_RF_48HR_REVIEW_COMPLETED_DATE',
				MINOR_MS_BUILD_CONSTRUCTION_COMPLETE_COMPLETED_DATE AS 'MINOR_MS_BUILD_CONSTRUCTION_COMPLETE_COMPLETED_DATE',
				MINOR_MS_ENVIRONMENTAL_NOTICE_TO_CONTRACTOR_COMPLETED_DATE AS 'MINOR_MS_ENVIRONMENTAL_NOTICE_TO_CONTRACTOR_COMPLETED_DATE',
				MINOR_MS_REGULATORY_48HR_REVIEW_COMPLETED_DATE AS 'MINOR_MS_REGULATORY_48HR_REVIEW_COMPLETED_DATE',
				MINOR_MS_REGULATORY_CONSTRUCTION_SR_COMPLETED_DATE AS 'MINOR_MS_REGULATORY_CONSTRUCTION_SR_COMPLETED_DATE',
                MINOR_MS_VCP_FAR_EDGE_INSTALLATION_COMPLETED_DATE AS 'MINOR_MS_VCP_FAR_EDGE_INSTALLATION_COMPLETED_DATE',
                MINOR_MS_DC_DISCOVERY_COMPLETED_DATE AS 'MINOR_MS_DC_DISCOVERY_COMPLETED_DATE',
                MINOR_MS_FAR_EDGE_INSTANTIATION_COMPLETED_DATE AS 'MINOR_MS_FAR_EDGE_INSTANTIATION_COMPLETED_DATE',
                MINOR_MS_VDU_DAY_0_COMPLETE_COMPLETED_DATE AS 'MINOR_MS_VDU_DAY_0_COMPLETE_COMPLETED_DATE',
                MINOR_MS_VDU_DAY_1_COMPLETE_COMPLETED_DATE AS 'MINOR_MS_VDU_DAY_1_COMPLETE_COMPLETED_DATE',
                MINOR_MS_VDU_DEPLOY_READINESS_COMPLETED_DATE AS 'MINOR_MS_VDU_DEPLOY_READINESS_COMPLETED_DATE',
                MINOR_MS_VCP_SUBCLOUD_DEPLOYMENT_INITIATED_COMPLETED_DATE AS 'MINOR_MS_VCP_SUBCLOUD_DEPLOYMENT_INITIATED_COMPLETED_DATE'
			    ) )
			) PTWS1 on FTFC.FIELD_NAME = PTWS1.FIELD_NAME
			WHERE FTFC.FIELD_NAME IN (
				SELECT	MMM.DEPENDENT_FIELD FROM PROJ_MAJOR_MILESTONE_MAPPING MMM
				    inner join FUZE_TRACKER_FIELD_CONFIG FTFC on MMM.MAJOR_MILESTONE = FTFC.FIELD_NAME
				    where MMM.IS_MANDATORY in ('C','MC')
				    and FTFC.EDIT_RULE = 'CALCULATED_DATE'
				    and FTFC.workstep_name = milestoneName
			    )
			AND FTFC.MODULE = FIELD_LIST.MODULE
		    );
		 DBMS_OUTPUT.PUT_LINE('ELSE fieldsData::'|| fieldsData );
		END IF;
		IF(fieldsData IS NOT NULL) THEN
		   dataList := dataList || fieldsData;
		END IF;
		DBMS_OUTPUT.PUT_LINE('dataList'|| dataList );
	    END LOOP;
	    --hubReadychanges start
	   IF(milestoneName = 'HUB_READY')THEN
		BEGIN

		    /*
		    SELECT TRANSPORT_VENDOR,ELECTRIC_COMPLT_AC_DT INTO v_hubTransportVendor,powerCompltDt
		    FROM PROJ_DEPENDENT_PROJECTS PDP
		    INNER JOIN PROJ_ST_FIELDS_DATA STP ON STP.SITE_PROJECTS_ID = PDP.SITE_PROJECTS_ID
		    INNER JOIN PROJ_TRANSPORT_ATTRIBUTES PTA ON PTA.SITE_PROJECTS_ID = PDP.SITE_PROJECTS_ID
		    WHERE PDP.PARENT_SITE_PROJECTS_ID = siteProjectsId AND UPPER(PDP.DEPENDENCY_TYPE)='HUB_READY';
			*/

		    SELECT TRANSPORT_VENDOR INTO v_hubTransportVendor
		    FROM ENTITY_ASSOCIATION_MAP PDP
		    INNER JOIN PROJ_TRANSPORT_ATTRIBUTES PTA ON PTA.SITE_PROJECTS_ID = PDP.PARENT_ID
		    WHERE PDP.CHILD_ID = siteProjectsId AND UPPER(PDP.ASSOCIATION_SUB_TYPE)='HUB_READY';

		EXCEPTION WHEN NO_DATA_FOUND THEN
			v_hubTransportVendor := 'N/A';
		END;

			IF(v_hubTransportVendor = 'N/A')THEN
			BEGIN
				SELECT TRANSPORT_VENDOR into v_hubTransportVendor FROM PROJ_TRANSPORT_ATTRIBUTES WHERE SITE_PROJECTS_ID= siteProjectsId;

			EXCEPTION WHEN NO_DATA_FOUND THEN
				v_hubTransportVendor := 'N/A';
			END;
			END IF;
		dataList := dataList || '"Hub Transport Vendor":"' || v_hubTransportVendor || '"';
		DBMS_OUTPUT.PUT_LINE('Hub_REAdy :: '|| dataList );
	    END IF;
		--hubReadychanges end

		--TransportM Enhancement
	   /* IF(milestoneName = 'TRANSPORT')THEN
		BEGIN
		    SELECT TRANSPORT_TYPE INTO v_transportType
			FROM PROJ_TRANSPORT_ATTRIBUTES PTA
			WHERE PTA.SITE_PROJECTS_ID = siteProjectsId;
		EXCEPTION WHEN NO_DATA_FOUND THEN
		    v_hubTransportVendor := 'N/A';
		    powerCompltDt := null;
		END;
		dataList := dataList || '"Transport Type":"' || v_transportType || '"';
		DBMS_OUTPUT.PUT_LINE('Hub_REAdy :: '|| dataList );
	    END IF; */

	     DBMS_OUTPUT.PUT_LINE(dataList);
	    preReq := preReq || '"' || milestoneName || '":{' || RTRIM(dataList,',') || '},';
       --  END LOOP;
    END IF;
    preReq := '{' || RTRIM(preReq,',') || '}';
    --DBMS_OUTPUT.PUT_LINE('preReq : '||preReq);
    RETURN preReq;
END;
